!function(e,t){t.orderEmp=dis.subscribe("orders_management_emp"),e("tbody").on("click",".view-order",function(e){var t={order_id:e.currentTarget.getAttribute("data-order_id")};return window.dis.trigger("view_order",t),!1}),e("tbody").on("click",".preview-email",function(e){var t={order_id:e.currentTarget.getAttribute("data-order_id")};return window.dis.trigger("preview_email",t),!1}),e("tbody").on("click",".send-ticket",function(e){var t={order_id:e.currentTarget.getAttribute("data-order_id")};return alertify.confirm("Has customer already get tickets? System will delete this row.",function(e){e?window.dis.trigger("send_ticket",t):alertify.error("Cancel action send tickets!","",0)}),!1}),privateChannel.bind("order_customer_preview_email",function(t){var r=t.order,d=(t.customer,""),n="",a="";d=r.adult_names.split(";").map(function(e){return"<p> Mr(s) "+e+"</p>"}).join(""),""!==r.children_names&&(n=r.children_names.split(";").map(function(e){return"<p> Child's name: "+e+"</p>"}).join("")),""!==r.infant_names&&(a=r.infant_names.split(";").map(function(e){return"<p> Infant's name: "+e+"</p>"}).join("")),e(".email_order_id").html(r.id),e(".email_customer_name").html(d+n+a),e(".email_order_created_at").html(new Date(r.created_at).toLocaleString()),e(".email_from").html(r.from),e(".email_to").html(r.to),e(".email_depart").html(r.depart_date),e(".email_return").html(r.return_date),e.magnificPopup.open({items:{src:".preview-email-wrap",type:"inline"}})}),privateChannel.bind("order_customer_send_email",function(){alertify.success("Send email successful!")}),privateChannel.bind("order_customer_send_tickets",function(){alertify.success("Send tickets successful!")}),orderEmp.bind("order_other_emp_view_order",function(t){var r=e(".order_id_"+t.id+" .order_status");r.removeClass().addClass("order_status viewed").html("VIEWED")}),orderEmp.bind("order_other_emp_send_email",function(t){var r=e(".order_id_"+t.id+" .order_status");r.removeClass().addClass("order_status sent-email").html("SENT EMAIL")}),orderEmp.bind("order_other_emp_send_ticket",function(t){var r=e(".order_id_"+t.id+" .order_status");r.removeClass().addClass("order_status sent-tickets").html("SENT TICKETS")}),orderEmp.bind("new_request",function(t){var r,d=e("table").data("footable"),n=["<span class='order_status new'>NEW</span>","<span class='order_status view-order'>VIEW ORDER</span>","<span class='order_status sent-email'>SENT EMAIL</span>","<span class='order_status sent-tickets'>SENT TICKETS</span>"];r=e("<tr><td>"+t.order.from+"</td><td>"+t.order.to+"</td><td>"+t.order.depart_date+"</td><td>"+(t.order.return_date||"&nbsp;")+"</td><td>"+new Date(t.order.created_at).toLocaleString()+"</td><td>"+n[t.order.status]+'</td><td><button class="view-order view-order btn btn-primary btn-sm"href="#" data-order_id="'+t.order.id+'">View order</button></td><td><button class="send-email btn btn-primary btn-sm" href="#" data-order_id="'+t.order.id+'">Send email</button></td><td><button class="send-ticket btn btn-primary btn-sm" href="#" data-order_id="'+t.order.id+'">Send ticket</button></td><td>'),d.appendRow(r)}),e(".footable").bind("footable_breakpoint",function(){e(".footable").trigger("footable_expand_first_row")}).footable()}(jQuery,window);